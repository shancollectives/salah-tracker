<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Salah Tracker</title>
    
    <!-- Scripts -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Icons & Branding -->
    <link rel="icon" type="image/png" href="https://i.ibb.co/ZRjmkWdj/Cream-Orange-Elegant-Mosque-Islamic-Center-Logo.png">
    <link rel="apple-touch-icon" href="https://i.ibb.co/ZRjmkWdj/Cream-Orange-Elegant-Mosque-Islamic-Center-Logo.png">
    
    <!-- Mobile App Settings (Android & iOS) -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#020617">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    
    <style>
        body { 
            font-family: 'Inter', sans-serif; 
            -webkit-tap-highlight-color: transparent; 
            overscroll-behavior-y: contain;
        }
        .animate-fade { 
            animation: fadeIn 0.3s ease-out forwards; 
        }
        @keyframes fadeIn { 
            from { opacity: 0; transform: translateY(8px); } 
            to { opacity: 1; transform: translateY(0); } 
        }
        /* Prevents text selection on long press for a more app-like feel */
        * { -webkit-user-select: none; user-select: none; }
        input, textarea { -webkit-user-select: text; user-select: text; }
    </style>
</head>
<body class="bg-black">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        const Icon = ({ name, className = "w-6 h-6" }) => {
            const icons = {
                fajr: <path d="M12 2v2m0 16v2M4.93 4.93l1.41 1.41m11.32 11.32l1.41 1.41M2 12h2m16 0h2M4.93 19.07l1.41-1.41m11.32-11.32l1.41-1.41M12 7a5 5 0 1 0 0 10 5 5 0 0 0 0-10z" />,
                dhuhr: <path d="M12 12m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" />,
                asr: <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42M12 8a4 4 0 1 1 0 8 4 4 0 0 1 0-8" />,
                maghrib: <path d="M17 18a5 5 0 0 0-10 0M2 20h20M12 2v4M4.22 4.22l2.83 2.83M19.78 4.22l-2.83 2.83" />,
                isha: <path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z" />,
                check: <path d="M20 6 9 17l-5-5" />,
                history: <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8m0-4v4h4" />,
                x: <path d="M18 6 6 18M6 6l12 12" />,
                chart: <path d="M3 3v18h18M7 16v-4M11 16V9M15 16v-7M19 16V5" />,
                flame: <path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z" />
            };
            return (
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                    {icons[name] || <circle cx="12" cy="12" r="10" />}
                </svg>
            );
        };

        const PrayerCard = ({ prayer, status, onUpdate, darkMode }) => {
            const styles = status === 'on_time' ? (darkMode ? 'bg-emerald-950/40 border-emerald-500 text-emerald-100' : 'bg-emerald-100 border-emerald-500 text-emerald-800') :
                           status === 'late' ? (darkMode ? 'bg-amber-950/40 border-amber-500 text-amber-100' : 'bg-amber-100 border-amber-500 text-amber-800') :
                           status === 'missed' ? (darkMode ? 'bg-rose-950/40 border-rose-500 text-rose-100' : 'bg-rose-100 border-rose-500 text-rose-800') :
                           (darkMode ? 'bg-slate-900 border-slate-700 text-slate-400' : 'bg-white border-slate-200 text-slate-500');

            return (
                <div className={`p-4 rounded-2xl border-2 transition-all mb-3 animate-fade shadow-sm ${styles}`}>
                    <div className="flex items-center justify-between mb-4">
                        <div className="flex items-center gap-3">
                            <div className={`p-2 rounded-full ${status ? 'bg-white/10' : 'bg-black/5'}`}>
                                <Icon name={prayer.id} className="w-6 h-6" />
                            </div>
                            <span className="font-bold text-lg">{prayer.name}</span>
                        </div>
                    </div>
                    <div className="flex gap-2">
                        <button onClick={() => onUpdate('on_time')} className={`flex-1 py-3 rounded-xl text-xs font-bold flex items-center justify-center gap-1 transition-all active:scale-95 ${status === 'on_time' ? 'bg-emerald-600 text-white' : 'bg-black/5'}`}>
                            <Icon name="check" className="w-3 h-3" /> On Time
                        </button>
                        <button onClick={() => onUpdate('late')} className={`flex-1 py-3 rounded-xl text-xs font-bold flex items-center justify-center gap-1 transition-all active:scale-95 ${status === 'late' ? 'bg-amber-500 text-white' : 'bg-black/5'}`}>
                            <Icon name="history" className="w-3 h-3" /> Late
                        </button>
                        <button onClick={() => onUpdate('missed')} className={`flex-1 py-3 rounded-xl text-xs font-bold flex items-center justify-center gap-1 transition-all active:scale-95 ${status === 'missed' ? 'bg-rose-500 text-white' : 'bg-black/5'}`}>
                            <Icon name="x" className="w-3 h-3" /> Missed
                        </button>
                    </div>
                </div>
            );
        };

        function App() {
            const [darkMode, setDarkMode] = useState(true);
            const [records, setRecords] = useState(() => JSON.parse(localStorage.getItem('salah_records') || '{}'));
            const [view, setView] = useState('daily');
            
            const prayers = [
                { id: 'fajr', name: 'Fajr' },
                { id: 'dhuhr', name: 'Dhuhr' },
                { id: 'asr', name: 'Asr' },
                { id: 'maghrib', name: 'Maghrib' },
                { id: 'isha', name: 'Isha' },
            ];

            const today = new Date().toISOString().split('T')[0];

            useEffect(() => {
                localStorage.setItem('salah_records', JSON.stringify(records));
            }, [records]);

            const handleUpdate = (id, status) => {
                setRecords(prev => ({
                    ...prev,
                    [today]: { ...prev[today], [id]: prev[today]?.[id] === status ? null : status }
                }));
            };

            const streak = useMemo(() => {
                let count = 0;
                let d = new Date();
                while (true) {
                    const key = d.toISOString().split('T')[0];
                    if (records[key] && Object.values(records[key]).some(v => v === 'on_time' || v === 'late')) {
                        count++;
                        d.setDate(d.getDate() - 1);
                    } else break;
                }
                return count;
            }, [records]);

            const progress = useMemo(() => {
                const day = records[today] || {};
                const count = Object.values(day).filter(v => v === 'on_time' || v === 'late').length;
                return (count / 5) * 100;
            }, [records, today]);

            return (
                <div className={`min-h-screen transition-colors ${darkMode ? 'bg-black text-white' : 'bg-slate-50 text-slate-900'}`}>
                    <header className={`sticky top-0 z-20 border-b p-4 pt-8 flex items-center justify-between ${darkMode ? 'bg-slate-950 border-slate-800' : 'bg-white border-slate-200'}`}>
                        <div className="flex items-center gap-3">
                            <div className="w-10 h-10 rounded-xl overflow-hidden border border-slate-700 bg-white p-1">
                                <img src="https://i.ibb.co/ZRjmkWdj/Cream-Orange-Elegant-Mosque-Islamic-Center-Logo.png" className="w-full h-full object-contain" alt="Logo" />
                            </div>
                            <h1 className="font-bold text-xl bg-gradient-to-r from-emerald-500 to-teal-400 bg-clip-text text-transparent">SalahTracker</h1>
                        </div>
                        <div className="flex items-center gap-3">
                            <div className="flex items-center gap-1 bg-orange-500/20 text-orange-500 px-3 py-1.5 rounded-full text-sm font-bold border border-orange-500/30">
                                <Icon name="flame" className="w-4 h-4" /> {streak}
                            </div>
                            <button onClick={() => setView(view === 'daily' ? 'stats' : 'daily')} className="p-2 rounded-full active:bg-slate-800 transition-colors">
                                <Icon name="chart" className="w-6 h-6 text-slate-400" />
                            </button>
                        </div>
                    </header>

                    <div className="w-full h-1 bg-slate-800">
                        <div className="h-full bg-emerald-500 transition-all duration-700 ease-out" style={{width: `${progress}%`}}></div>
                    </div>

                    <main className="max-w-md mx-auto p-4 pb-24">
                        <div className="mb-6 animate-fade">
                            <h2 className="text-xs font-bold text-slate-500 uppercase tracking-widest">{new Date().toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric' })}</h2>
                        </div>

                        {view === 'daily' ? (
                            <div className="space-y-1">
                                {prayers.map(p => (
                                    <PrayerCard key={p.id} prayer={p} status={records[today]?.[p.id]} onUpdate={(s) => handleUpdate(p.id, s)} darkMode={darkMode} />
                                ))}
                            </div>
                        ) : (
                            <div className="animate-fade space-y-4">
                                <div className="bg-gradient-to-br from-emerald-600 to-teal-700 p-6 rounded-3xl text-white shadow-lg">
                                    <h3 className="text-xl font-bold mb-1">Prayer Statistics</h3>
                                    <p className="text-emerald-100 text-sm opacity-90 leading-relaxed">You have maintained a {streak} day streak. May Allah make it easy for you to stay consistent.</p>
                                </div>
                                <div className="grid grid-cols-2 gap-3">
                                    <div className="bg-slate-900 p-4 rounded-2xl border border-slate-800 text-center">
                                        <p className="text-slate-500 text-xs font-bold uppercase mb-1">Total Streak</p>
                                        <p className="text-3xl font-bold">{streak}</p>
                                    </div>
                                    <div className="bg-slate-900 p-4 rounded-2xl border border-slate-800 text-center">
                                        <p className="text-slate-500 text-xs font-bold uppercase mb-1">Today's Goal</p>
                                        <p className="text-3xl font-bold">{Math.round(progress)}%</p>
                                    </div>
                                </div>
                                <button onClick={() => setView('daily')} className="w-full py-4 bg-white text-black rounded-2xl font-bold active:scale-95 transition-transform">Back to Home</button>
                            </div>
                        )}
                    </main>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
